package com.lti.util.validate;

import java.util.ArrayList;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.PatternSyntaxException;

import org.apache.commons.httpclient.HttpClient;
import org.apache.commons.httpclient.HttpMethod;
import org.apache.commons.httpclient.methods.GetMethod;
import org.hibernate.hql.classic.ParserHelper;

import com.lti.util.html.ParseHtmlTable;
import com.sun.org.apache.xalan.internal.xsltc.compiler.Pattern;


public class ParseStatement {

	private java.lang.Long securityID;
	// private String logFile;

	// http://quicktake.morningstar.com/FundNet/TotalReturns.aspx?Country=USA&Symbol=VWEHX
	public static String URL = "http://quicktake.morningstar.com/StockNet/income10.aspx";
	// http://quicktake.morningstar.com/etfnet/TotalReturns.aspx?Country=USA&Symbol=AGG
	public static String Country = "USA";
	public static String testURL = "http://202.116.76.163:8000/LTISystem";

	public ParseStatement() {

	}

	public static String getStatementHTML(String url, String country, String symbol) throws Exception {
		if (url == null)
			url = URL;
		if (country == null)
			country = Country;
		if (symbol == null)
			return null;
		String connectUrl = url + "?Country=" + country + "&Symbol=" + symbol;
		HttpClient client = new HttpClient();
		HttpMethod method = new GetMethod(connectUrl);
		String r = null;
		try {
			client.executeMethod(method);
			r = method.getResponseBodyAsString();
		} catch (Exception e) {
			throw e;
		} finally {
			try {
				method.releaseConnection();
			} catch (Exception e) {
			}
		}
		return r;
	}

	


	public static void main(String[] args) throws Exception {
		//String src=getStatementHTML(null, null, "IBM");
		String clrSrc=null;//=ParseHtmlTable.cleanHtml(src);
		clrSrc="<table><tr><td></td><td> </td><td> </td><td></td><td> </td><td> </td><td></td></tr></table><table><tr><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td> <table><tr><td>SNAPSHOT</td></tr><tr><td>QUOTE &AMP; NEWS</td></tr><tr><td>CHART BETA</td></tr><tr><td> ANALYST RESEARCH</td></tr><tr><td> MORNINGSTAR RATING</td></tr><tr><td>OPTIONS</td></tr><tr><td>VALUATION RATIOS</td></tr><tr><td>FINANCIAL STATEMENTS</td></tr><tr><td>KEY RATIOS</td></tr><tr><td>PERFORMANCE</td></tr><tr><td>INSIDER TRADING</td></tr><tr><td>SEC FILINGS </td></tr><tr><td>DATA INTERPRETER</td></tr></table><table><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr></table><table><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr></table></td><td> <table> <tr> <td></td></tr></table></td><td> <table> <tr><td> <table><tr><td></td></tr><tr><td>INTERNATIONAL BUSINESS MACHINES CORP IBM</td><td></td></tr><tr><td></td></tr><tr><td></td></tr></table></td></tr><tr><td> <table> <tr> <td> 0) { SVALUE= THIS.SELECTSINGLENODE(SMATCH).NODETYPEDVALUE; IF(SVALUE.LENGTH == 7) { RETURN SVALUE.SUBSTR(5,2)+'-'+SVALUE.SUBSTR(0,4); } IF(SVALUE.LENGTH == 10) { RETURN SVALUE.SUBSTR(5,5)+'-'+SVALUE.SUBSTR(0,4); } IF(SVALUE.LENGTH == 8) { IF(SVALUE.SUBSTR(6,2)<table><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td></tr></table><table><tr><td></td></tr><tr><td>INCOME STATEMENT</td><td>AS ORIGINALLY REPORTED</td></tr><tr><td></td><td></td></tr><tr><td>REVENUE (FROM 1999 TO 2008) $MIL</td><td>FISCAL YEAR-END: 12</td></tr><tr><td></td><td></td></tr></table><table><tr><td></td></tr><tr><td></td></tr></table><table><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td>1999</td><td></td><td></td><td>2000</td><td></td><td></td><td>2001</td><td></td><td></td><td>2002</td><td></td><td></td><td>2003</td><td></td><td></td><td>2004</td><td></td><td></td><td>2005</td><td></td><td></td><td>2006</td><td></td><td></td><td>2007</td><td></td><td></td><td>2008</td><td></td><td></td><td>TTM</td><td></td></tr><tr><td>REVENUE</td><td></td><td>87,548.0</td><td></td><td></td><td>88,396.0</td><td></td><td></td><td>85,866.0</td><td></td><td></td><td>81,186.0</td><td></td><td></td><td>89,131.0</td><td></td><td></td><td>96,293.0</td><td></td><td></td><td>91,134.0</td><td></td><td></td><td>91,424.0</td><td></td><td></td><td>98,786.0</td><td></td><td></td><td>103,630.0</td><td></td><td></td><td>103,630.0</td><td></td></tr><tr><td>COGS</td><td></td><td>55,619.0</td><td></td><td></td><td>55,972.0</td><td></td><td></td><td>54,084.0</td><td></td><td></td><td>50,902.0</td><td></td><td></td><td>56,113.0</td><td></td><td></td><td>60,261.0</td><td></td><td></td><td>54,602.0</td><td></td><td></td><td>53,129.0</td><td></td><td></td><td>57,057.0</td><td></td><td></td><td>57,969.0</td><td></td><td></td><td>57,969.0</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>GROSS PROFIT</td><td></td><td>31,929.0</td><td></td><td></td><td>32,424.0</td><td></td><td></td><td>31,782.0</td><td></td><td></td><td>30,284.0</td><td></td><td></td><td>33,018.0</td><td></td><td></td><td>36,032.0</td><td></td><td></td><td>36,532.0</td><td></td><td></td><td>38,295.0</td><td></td><td></td><td>41,729.0</td><td></td><td></td><td>45,661.0</td><td></td><td></td><td>45,661.0</td><td></td></tr></table><table><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>OPERATING EXPENSES $MIL</td></tr><tr><td></td><td></td><td>1999</td><td></td><td></td><td>2000</td><td></td><td></td><td>2001</td><td></td><td></td><td>2002</td><td></td><td></td><td>2003</td><td></td><td></td><td>2004</td><td></td><td></td><td>2005</td><td></td><td></td><td>2006</td><td></td><td></td><td>2007</td><td></td><td></td><td>2008</td><td></td><td></td><td>TTM</td><td></td></tr><tr><td>SG&A</td><td></td><td>14,729.0</td><td></td><td></td><td>15,639.0</td><td></td><td></td><td>17,197.0</td><td></td><td></td><td>18,738.0</td><td></td><td></td><td>17,852.0</td><td></td><td></td><td>19,384.0</td><td></td><td></td><td>21,314.0</td><td></td><td></td><td>20,259.0</td><td></td><td></td><td>22,060.0</td><td></td><td></td><td>23,386.0</td><td></td><td></td><td>23,386.0</td><td></td></tr><tr><td>R&D</td><td></td><td>5,273.0</td><td></td><td></td><td>5,151.0</td><td></td><td></td><td>5,290.0</td><td></td><td></td><td>4,750.0</td><td></td><td></td><td>5,077.0</td><td></td><td></td><td>5,673.0</td><td></td><td></td><td>5,842.0</td><td></td><td></td><td>6,107.0</td><td></td><td></td><td>6,153.0</td><td></td><td></td><td>6,337.0</td><td></td><td></td><td>6,337.0</td><td></td></tr><tr><td>OTHER</td><td></td><td>0.0</td><td></td><td></td><td>100.0</td><td></td><td></td><td>(1,658.0)</td><td></td><td></td><td>(728.0)</td><td></td><td></td><td>(785.0)</td><td></td><td></td><td>(1,053.0)</td><td></td><td></td><td>(2,850.0)</td><td></td><td></td><td>(1,388.0)</td><td></td><td></td><td>(973.0)</td><td></td><td></td><td>(778.0)</td><td></td><td></td><td>(778.0)</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>OPERATING INCOME</td><td></td><td>11,927.0</td><td></td><td></td><td>11,534.0</td><td></td><td></td><td>10,953.0</td><td></td><td></td><td>7,524.0</td><td></td><td></td><td>10,874.0</td><td></td><td></td><td>12,028.0</td><td></td><td></td><td>12,226.0</td><td></td><td></td><td>13,317.0</td><td></td><td></td><td>14,489.0</td><td></td><td></td><td>16,716.0</td><td></td><td></td><td>16,716.0</td><td></td></tr></table><table><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>OTHER INCOME AND EXPENSE $MIL</td></tr><tr><td></td><td></td><td>1999</td><td></td><td></td><td>2000</td><td></td><td></td><td>2001</td><td></td><td></td><td>2002</td><td></td><td></td><td>2003</td><td></td><td></td><td>2004</td><td></td><td></td><td>2005</td><td></td><td></td><td>2006</td><td></td><td></td><td>2007</td><td></td><td></td><td>2008</td><td></td><td></td><td>TTM</td><td></td></tr><tr><td>NET INT INC & OTHER</td><td></td><td>(170.0)</td><td></td><td></td><td>(717.0)</td><td></td><td></td><td>(238.0)</td><td></td><td></td><td>(145.0)</td><td></td><td></td><td>(145.0)</td><td></td><td></td><td>(139.0)</td><td></td><td></td><td>(220.0)</td><td></td><td></td><td>(278.0)</td><td></td><td></td><td>(611.0)</td><td></td><td></td><td>(674.0)</td><td></td><td></td><td>(674.0)</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>EARNINGS BEFORE TAXES</td><td></td><td>11,757.0</td><td></td><td></td><td>11,534.0</td><td></td><td></td><td>10,953.0</td><td></td><td></td><td>7,524.0</td><td></td><td></td><td>10,874.0</td><td></td><td></td><td>12,028.0</td><td></td><td></td><td>12,226.0</td><td></td><td></td><td>13,317.0</td><td></td><td></td><td>14,489.0</td><td></td><td></td><td>16,715.0</td><td></td><td></td><td>16,715.0</td><td></td></tr><tr><td>INCOME TAXES</td><td></td><td>4,045.0</td><td></td><td></td><td>3,441.0</td><td></td><td></td><td>3,230.0</td><td></td><td></td><td>2,190.0</td><td></td><td></td><td>3,261.0</td><td></td><td></td><td>3,580.0</td><td></td><td></td><td>4,232.0</td><td></td><td></td><td>3,901.0</td><td></td><td></td><td>4,071.0</td><td></td><td></td><td>4,381.0</td><td></td><td></td><td>4,381.0</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>EARNINGS AFTER TAXES</td><td></td><td>7,712.0</td><td></td><td></td><td>8,093.0</td><td></td><td></td><td>7,723.0</td><td></td><td></td><td>5,334.0</td><td></td><td></td><td>7,613.0</td><td></td><td></td><td>8,448.0</td><td></td><td></td><td>7,994.0</td><td></td><td></td><td>9,416.0</td><td></td><td></td><td>10,418.0</td><td></td><td></td><td>12,334.0</td><td></td><td></td><td>12,334.0</td><td></td></tr><tr><td>ACCTG CHANGES</td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td>(36.0)</td><td></td><td></td><td>0.0</td><td></td><td></td><td>0.0</td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td></tr><tr><td>DISC OPERATIONS</td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td>(1,755.0)</td><td></td><td></td><td>(30.0)</td><td></td><td></td><td>(18.0)</td><td></td><td></td><td>(24.0)</td><td></td><td></td><td>76.0</td><td></td><td></td><td>0.0</td><td></td><td></td><td>0.0</td><td></td><td></td><td>0.0</td><td></td></tr><tr><td>EXT ITEMS</td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td><td></td><td> --- </td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>NET INCOME</td><td></td><td>7,712.0</td><td></td><td></td><td>8,093.0</td><td></td><td></td><td>7,723.0</td><td></td><td></td><td>3,579.0</td><td></td><td></td><td>7,583.0</td><td></td><td></td><td>8,430.0</td><td></td><td></td><td>7,934.0</td><td></td><td></td><td>9,492.0</td><td></td><td></td><td>10,418.0</td><td></td><td></td><td>12,334.0</td><td></td><td></td><td>12,334.0</td><td></td></tr><tr><td>DILUTED EPS, CONT OPS$</td><td></td><td>4.12</td><td></td><td></td><td>4.44</td><td></td><td></td><td>4.35</td><td></td><td></td><td>3.07</td><td></td><td></td><td>4.34</td><td></td><td></td><td>4.94</td><td></td><td></td><td>4.91</td><td></td><td></td><td>6.06</td><td></td><td></td><td>7.18</td><td></td><td></td><td>8.93</td><td></td><td></td><td>8.93</td><td></td></tr><tr><td>DILUTED EPS$</td><td></td><td>4.12</td><td></td><td></td><td>4.44</td><td></td><td></td><td>4.35</td><td></td><td></td><td>2.06</td><td></td><td></td><td>4.32</td><td></td><td></td><td>4.93</td><td></td><td></td><td>4.87</td><td></td><td></td><td>6.11</td><td></td><td></td><td>7.18</td><td></td><td></td><td>8.93</td><td></td><td></td><td>8.93</td><td></td></tr><tr><td>SHARES</td><td></td><td>1871</td><td></td><td></td><td>1822</td><td></td><td></td><td>1775</td><td></td><td></td><td>1730</td><td></td><td></td><td>1756</td><td></td><td></td><td>1708</td><td></td><td></td><td>1627</td><td></td><td></td><td>1553</td><td></td><td></td><td>1450</td><td></td><td></td><td>1381</td><td></td><td></td><td>1381</td><td></td></tr></table><table><tr><td></td></tr><tr><td></td></tr><tr><td>S&AMP;P INDEX DATA: S&AMP;P 500 COPYRIGHT 2009 </td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>SHOW DATA DEFINITIONS | FEEDBACK | PERMISSIONS/REPRINTS | TICKER LOOKUP</td></tr><tr><td></td></tr><tr><td></td></tr></table></td><td> </td><td> </td></tr></table></td></tr></table></td></tr></table>";
		System.out.println(ParseHtmlTable.getTable(clrSrc, 13));
		String table="<TABLE><TR><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD></TR><TR><TD></TD><TD></TD><TD>1999</TD><TD></TD><TD></TD><TD>2000</TD><TD></TD><TD></TD><TD>2001</TD><TD></TD><TD></TD><TD>2002</TD><TD></TD><TD></TD><TD>2003</TD><TD></TD><TD></TD><TD>2004</TD><TD></TD><TD></TD><TD>2005</TD><TD></TD><TD></TD><TD>2006</TD><TD></TD><TD></TD><TD>2007</TD><TD></TD><TD></TD><TD>2008</TD><TD></TD><TD></TD><TD>TTM</TD><TD></TD></TR><TR><TD>REVENUE</TD><TD></TD><TD>87,548.0</TD><TD></TD><TD></TD><TD>88,396.0</TD><TD></TD><TD></TD><TD>85,866.0</TD><TD></TD><TD></TD><TD>81,186.0</TD><TD></TD><TD></TD><TD>89,131.0</TD><TD></TD><TD></TD><TD>96,293.0</TD><TD></TD><TD></TD><TD>91,134.0</TD><TD></TD><TD></TD><TD>91,424.0</TD><TD></TD><TD></TD><TD>98,786.0</TD><TD></TD><TD></TD><TD>103,630.0</TD><TD></TD><TD></TD><TD>103,630.0</TD><TD></TD></TR><TR><TD>COGS</TD><TD></TD><TD>55,619.0</TD><TD></TD><TD></TD><TD>55,972.0</TD><TD></TD><TD></TD><TD>54,084.0</TD><TD></TD><TD></TD><TD>50,902.0</TD><TD></TD><TD></TD><TD>56,113.0</TD><TD></TD><TD></TD><TD>60,261.0</TD><TD></TD><TD></TD><TD>54,602.0</TD><TD></TD><TD></TD><TD>53,129.0</TD><TD></TD><TD></TD><TD>57,057.0</TD><TD></TD><TD></TD><TD>57,969.0</TD><TD></TD><TD></TD><TD>57,969.0</TD><TD></TD></TR><TR><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD></TR><TR><TD></TD></TR><TR><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD></TR><TR><TD>GROSS PROFIT</TD><TD></TD><TD>31,929.0</TD><TD></TD><TD></TD><TD>32,424.0</TD><TD></TD><TD></TD><TD>31,782.0</TD><TD></TD><TD></TD><TD>30,284.0</TD><TD></TD><TD></TD><TD>33,018.0</TD><TD></TD><TD></TD><TD>36,032.0</TD><TD></TD><TD></TD><TD>36,532.0</TD><TD></TD><TD></TD><TD>38,295.0</TD><TD></TD><TD></TD><TD>41,729.0</TD><TD></TD><TD></TD><TD>45,661.0</TD><TD></TD><TD></TD><TD>45,661.0</TD><TD></TD></TR></TABLE>";
		System.out.println(ParseHtmlTable.removeColumn(table, 6));
		//String table_3=ParseHtmlTable.getContent(clrSrc, 1, 1, 1);
		
		//System.out.println((getStatementHTML(null, null, "IBM")));
	}
}
